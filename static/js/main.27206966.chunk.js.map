{"version":3,"sources":["Geometry.js","Gamestate.js","Board.js","Buttons.js","Theme.js","Loader.js","Settings.js","App.js","serviceWorker.js","index.js"],"names":["row","n","Range","col","rowOf","s","Math","floor","Set","colOf","boxOf","boxrow","boxcol","flatMap","affectedBy","union","createBoard","numbers","Repeat","size","Error","length","map","number","Map","corners","centers","locked","toList","removePencilMark","board","squares","type","digit","reduce","square","updateIn","marks","remove","canUndo","gamestate","get","canRedo","Modes","Action","updateGamestate","action","mode","settings","updater","currentBoard","getIn","newBoard","is","merge","boards","slice","push","index","updateBoard","affectedSquares","withMutations","setIn","setNumber","incompleteSquares","filter","effectiveMode","clearPencilMarks","i","some","hasIn","anyContains","add","addPencilMark","update","undo","redo","getErrors","rows","r","columns","c","boxes","b","base","concat","box","sections","errorSquares","asMutable","forEach","section","squareNumbers","v","numberCounts","countBy","asImmutable","Board","children","handleTouchMove","boardAreaRef","errors","selection","highlights","intersect","BoardArea","ref","BoardSizer","BoardGrid","onTouchMove","renderBox","Box","renderSquare","ibox","isquare","indexbox","Square","error","includes","hasCursor","usingCursor","cursor","highlighted","selected","styled","div","CORNER_GRID_AREA_SETS","1","2","3","4","5","6","7","8","9","Cursor","number_or_hints","Corners","Centers","classes","StyledSquare","className","join","data-index","p","theme","squareHighlighted","squareSelected","squareError","squareSelectedError","squareLocked","brighten","Number","StyledNumber","cornerNumbers","sort","cornerGridAreas","cornerEntries","area","charAt","StyledCorners","style","gridArea","StyledCenters","StyledButtonRow","ButtonRow","large","stretch","StyledButtonBase","button","darken","text","StyledButton","props","desaturate","Button","active","enabled","onClick","as","disabled","FocusSelector","icon","faSearch","makeTheme","background","chroma","border","lch","mix","Themes","red","orange","yellow","green","cyan","blue","indigo","purple","default","ModeTheme","encodeBoard","INITIAL_SETTINGS","automaticallyRemoveHints","highlightAffectedSquares","showErrors","showLocked","SettingAction","updateSettings","name","value","Settings","dispatchSettings","SettingsFlex","SettingsGroup","SettingsUl","Toggle","dispatch","fieldset","ul","SettingsListItem","id","checked","onChange","for","li","encoded","searchParams","URLSearchParams","window","location","search","initialBoard","has","List","char","parsed","parseInt","App","useState","setMode","useReducer","initial_board","of","dispatchGamestate","setSelection","currentErrors","useMemo","clearSelection","useCallback","newSelection","selectSquare","console","log","selectSquareAtCoordinates","x","y","element","document","elementFromPoint","hasAttribute","parentElement","getAttribute","squareAt","selectDirection","direction","neighbor","inputDigit","selectTouchedSquares","e","changedTouches","touch","pageX","pageY","handleTouchStart","preventDefault","touches","ctrlKey","handleMouseDown","shiftKey","handleMouseMove","buttons","moveCursor","key","substring","toLowerCase","handleKeyDown","useEffect","addEventListener","removeEventListener","boardArea","useRef","node","current","GlobalStyle","FlexRow","faUndo","faRedo","faBackspace","boardstr","url","URL","href","params","set","toString","navigator","clipboard","writeText","copyBoardAsURL","createGlobalStyle","Boolean","hostname","match","ReactDOM","render","StrictMode","getElementById","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.27206966.chunk.js","sourcesContent":["import { Set, Range } from \"immutable\";\n\nexport function squareAt(x, y) {\n  let element = document.elementFromPoint(x, y);\n  while (element !== null) {\n    if (element.hasAttribute(\"data-index\")) break;\n    element = element.parentElement;\n  }\n  if (element != null) {\n    let i = parseInt(element.getAttribute(\"data-index\"));\n    return i;\n  }\n  return null;\n}\n\nexport function neighbor(s, direction) {\n  switch (direction) {\n    case \"left\":\n      return s % 9 > 0 ? s - 1 : null;\n    case \"down\":\n      return Math.floor(s / 9) < 8 ? s + 9 : null;\n    case \"up\":\n      return Math.floor(s / 9) > 0 ? s - 9 : null;\n    case \"right\":\n      return s % 9 < 8 ? s + 1 : null;\n    default:\n      console.log(\n        `neighbor was called with an invalid direction: ${direction}`\n      );\n      return null;\n  }\n}\n\nexport function indexbox(ibox, isquare) {\n  const boxrow = Math.floor(ibox / 3);\n  const boxcol = ibox % 3;\n  const actualrow = boxrow * 3 + Math.floor(isquare / 3);\n  const actualcol = boxcol * 3 + (isquare % 3);\n  return actualrow * 9 + actualcol;\n}\n\nexport function row(n) {\n  return Range(9 * n, 9 * n + 9);\n}\n\nexport function col(n) {\n  return Range(n, 81, 9);\n}\n\nexport function box(n) {\n  const boxrow = Math.floor(n / 3);\n  const boxcol = n % 3;\n  const base = 27 * boxrow + 3 * boxcol;\n  return Range(base, base + 3).concat(\n    Range(base + 9, base + 9 + 3),\n    Range(base + 18, base + 18 + 3)\n  );\n}\n\nexport function rowOf(s) {\n  const row = Math.floor(s / 9);\n  return Set(Range(9 * row, 9 * row + 9));\n}\n\nexport function colOf(s) {\n  const col = s % 9;\n  return Set(Range(col, 81, 9));\n}\n\nexport function boxOf(s) {\n  const boxrow = Math.floor(Math.floor(s / 9) / 3);\n  const boxcol = Math.floor((s % 9) / 3);\n  return Set(\n    Range(3 * boxrow, 3 * (boxrow + 1)).flatMap((row) =>\n      Range(9 * row + 3 * boxcol, 9 * row + 3 * (boxcol + 1))\n    )\n  );\n}\n\nexport function affectedBy(s) {\n  return Set.union([rowOf(s), colOf(s), boxOf(s)]);\n}\n\nexport function rows() {\n  return Range(0, 81, 9).map((s) => row(s));\n}\n\nexport function cols() {\n  return Range(0, 9).map((s) => col(s));\n}\n\nexport function boxes() {\n  return Range(0, 2);\n}\n","import { List, Map, Set, Range, Repeat, is } from \"immutable\";\nimport { affectedBy, row, col, box } from \"./Geometry.js\";\n\nexport function createBoard(numbers) {\n  numbers = numbers ?? Repeat(null, 81);\n  if (numbers.size !== 81) {\n    throw new Error(`numbers had length ${numbers.length}; expected 81`);\n  }\n  return numbers\n    .map((number) =>\n      Map({\n        number: number,\n        corners: Set(),\n        centers: Set(),\n        locked: number !== null,\n      })\n    )\n    .toList();\n}\n\nexport function anyContains(board, squares, type, digit) {\n  return squares\n    .map((i) => board.get(i))\n    .some((square) => square.hasIn([type, digit]));\n}\n\nexport function setNumber(settings, board, square, digit) {\n  if (board.getIn([square, \"locked\"])) {\n    return board;\n  }\n  const affectedSquares = affectedBy(square);\n  return board.withMutations((board) => {\n    board.setIn([square, \"number\"], digit);\n    if (settings.get(\"automaticallyRemoveHints\")) {\n      removePencilMark(board, affectedSquares, \"corners\", digit);\n      removePencilMark(board, affectedSquares, \"centers\", digit);\n    }\n  });\n}\n\nexport function addPencilMark(board, squares, type, digit) {\n  return squares.reduce(\n    (board, square) =>\n      board.updateIn([square, type], (marks) => marks.add(digit)),\n    board\n  );\n}\n\nexport function clearPencilMarks(board, squares, type) {\n  return squares.reduce(\n    (board, square) => board.setIn([square, type], Set()),\n    board\n  );\n}\n\nexport function removePencilMark(board, squares, type, digit) {\n  return squares.reduce(\n    (board, square) =>\n      board.updateIn([square, type], (marks) => marks.remove(digit)),\n    board\n  );\n}\n\nexport function createGamestate(initial_board) {\n  return Map({\n    boards: List.of(initial_board),\n    index: 0,\n  });\n}\n\nexport function updateBoard(gamestate, updater) {\n  const currentBoard = gamestate.getIn([\"boards\", gamestate.get(\"index\")]);\n  const newBoard = updater(currentBoard);\n  if (is(newBoard, currentBoard)) {\n    return gamestate;\n  }\n  return gamestate.merge({\n    boards: gamestate\n      .get(\"boards\")\n      .slice(0, gamestate.get(\"index\") + 1)\n      .push(newBoard),\n    index: gamestate.get(\"index\") + 1,\n  });\n}\n\nfunction undo(gamestate) {\n  return canUndo(gamestate)\n    ? gamestate.update(\"index\", (i) => i - 1)\n    : gamestate;\n}\n\nfunction redo(gamestate) {\n  return canRedo(gamestate)\n    ? gamestate.update(\"index\", (i) => i + 1)\n    : gamestate;\n}\n\nexport function canUndo(gamestate) {\n  return gamestate.get(\"index\") > 0;\n}\n\nexport function canRedo(gamestate) {\n  return gamestate.get(\"index\") < gamestate.get(\"boards\").size - 1;\n}\n\nexport const Modes = {\n  normal: \"normal\",\n  corners: \"corners\",\n  centers: \"centers\",\n};\n\nexport const Action = {\n  input: \"input\",\n  undo: \"undo\",\n  redo: \"redo\",\n};\n\nexport function updateGamestate(\n  gamestate,\n  { action, mode, squares, digit, settings }\n) {\n  switch (action) {\n    case Action.input:\n      return updateBoard(gamestate, (board) => {\n        if (\n          (mode === Modes.normal && squares.length === 1) ||\n          (mode === Modes.normal && digit === null)\n        ) {\n          return setNumber(settings, board, squares[0], digit);\n        } else if (\n          mode === Modes.normal ||\n          mode === Modes.corners ||\n          mode === Modes.centers\n        ) {\n          const incompleteSquares = squares.filter(\n            (s) => board.get(s).get(\"number\") === null\n          );\n          const effectiveMode = mode === Modes.normal ? Modes.corners : mode;\n          if (digit === null) {\n            return clearPencilMarks(board, incompleteSquares, effectiveMode);\n          } else if (\n            anyContains(board, incompleteSquares, effectiveMode, digit)\n          ) {\n            return removePencilMark(\n              board,\n              incompleteSquares,\n              effectiveMode,\n              digit\n            );\n          } else {\n            return addPencilMark(\n              board,\n              incompleteSquares,\n              effectiveMode,\n              digit\n            );\n          }\n        } else {\n          throw new Error(`Invalid mode: ${mode}`);\n        }\n      });\n    case Action.undo:\n      return undo(gamestate);\n    case Action.redo:\n      return redo(gamestate);\n    default:\n      throw new Error(`Invalid action: ${action}`);\n  }\n}\n\nexport function getErrors(board) {\n  const rows = Range(0, 9).map((r) => row(r));\n  const columns = Range(0, 9).map((c) => col(c));\n  const boxes = Range(0, 9).map((b) => box(b));\n  const sections = rows.concat(columns, boxes);\n  const errorSquares = Set().asMutable();\n  sections.forEach((section) => {\n    const squareNumbers = Map(\n      section.map((s) => [s, board.getIn([s, \"number\"])])\n    ).filter((v) => v !== null);\n    const numberCounts = squareNumbers.countBy((number) => number);\n    squareNumbers.forEach((number, s) => {\n      if (numberCounts.get(number) > 1) {\n        errorSquares.add(s);\n      }\n    });\n  });\n  return errorSquares.asImmutable();\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { Set } from \"immutable\";\n\nimport { indexbox, affectedBy } from \"./Geometry.js\";\n\nexport function Board({\n  children,\n  handleTouchMove,\n  boardAreaRef,\n  board,\n  errors,\n  selection,\n  settings,\n}) {\n  const highlights = settings.get(\"highlightAffectedSquares\")\n    ? Set.intersect(selection.squares.map(affectedBy))\n    : Set();\n  return (\n    <BoardArea ref={boardAreaRef}>\n      <BoardSizer>\n        <BoardGrid onTouchMove={handleTouchMove}>\n          {renderBox(0, board, errors, selection, highlights, settings)}\n          {renderBox(1, board, errors, selection, highlights, settings)}\n          {renderBox(2, board, errors, selection, highlights, settings)}\n          {renderBox(3, board, errors, selection, highlights, settings)}\n          {renderBox(4, board, errors, selection, highlights, settings)}\n          {renderBox(5, board, errors, selection, highlights, settings)}\n          {renderBox(6, board, errors, selection, highlights, settings)}\n          {renderBox(7, board, errors, selection, highlights, settings)}\n          {renderBox(8, board, errors, selection, highlights, settings)}\n        </BoardGrid>\n      </BoardSizer>\n    </BoardArea>\n  );\n}\n\nfunction renderBox(i, board, errors, selection, highlights, settings) {\n  return (\n    <Box>\n      {renderSquare(i, 0, board, errors, selection, highlights, settings)}\n      {renderSquare(i, 1, board, errors, selection, highlights, settings)}\n      {renderSquare(i, 2, board, errors, selection, highlights, settings)}\n      {renderSquare(i, 3, board, errors, selection, highlights, settings)}\n      {renderSquare(i, 4, board, errors, selection, highlights, settings)}\n      {renderSquare(i, 5, board, errors, selection, highlights, settings)}\n      {renderSquare(i, 6, board, errors, selection, highlights, settings)}\n      {renderSquare(i, 7, board, errors, selection, highlights, settings)}\n      {renderSquare(i, 8, board, errors, selection, highlights, settings)}\n    </Box>\n  );\n}\n\nfunction renderSquare(\n  ibox,\n  isquare,\n  board,\n  errors,\n  selection,\n  highlights,\n  settings\n) {\n  const i = indexbox(ibox, isquare);\n  const square = board.get(i);\n  return (\n    <Square\n      index={i}\n      error={errors.includes(i)}\n      hasCursor={selection.usingCursor && selection.cursor === i}\n      highlighted={highlights.includes(i)}\n      selected={selection.squares.includes(i)}\n      locked={square.get(\"locked\")}\n      number={square.get(\"number\")}\n      corners={square.get(\"corners\")}\n      centers={square.get(\"centers\")}\n      settings={settings}\n    />\n  );\n}\n\nconst BoardArea = styled.div`\n  touch-action: none;\n`;\n\nconst BoardSizer = styled.div`\n  --box-gap: 4px;\n  --square-gap: 2px;\n  --square-size: 4rem;\n\n  position: relative;\n  height: calc(\n    9 * var(--square-size) + 6 * var(--square-gap) + 2 * var(--box-gap)\n  );\n  width: calc(\n    9 * var(--square-size) + 6 * var(--square-gap) + 2 * var(--box-gap)\n  );\n  margin: 0 auto;\n`;\n\nconst BoardGrid = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n\n  display: grid;\n  grid-template-columns: 1fr 1fr 1fr;\n  grid-template-rows: 1fr 1fr 1fr;\n  column-gap: var(--box-gap);\n  row-gap: var(--box-gap);\n\n  touch-action: none;\n`;\n\nexport const Box = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr 1fr;\n  grid-template-rows: 1fr 1fr 1fr;\n  column-gap: var(--square-gap);\n  row-gap: var(--square-gap);\n\n  user-select: none;\n`;\n\nconst CORNER_GRID_AREA_SETS = {\n  1: \"a\",\n  2: \"ac\",\n  3: \"acg\",\n  4: \"acgi\",\n  5: \"abcgi\",\n  6: \"abcghi\",\n  7: \"abcdghi\",\n  8: \"abcdfghi\",\n  9: \"abcdefghi\",\n};\n\nexport default function Square({\n  centers,\n  corners,\n  error,\n  hasCursor,\n  highlighted,\n  index,\n  number,\n  selected,\n  locked,\n  settings,\n}) {\n  let cursor = null;\n  if (hasCursor) {\n    cursor = <Cursor />;\n  }\n\n  let number_or_hints = [];\n  if (number !== null) {\n    number_or_hints.push(<Number>{number}</Number>);\n  } else {\n    if (corners !== null) {\n      number_or_hints.push(<Corners corners={corners} />);\n    }\n    if (centers !== null) {\n      number_or_hints.push(<Centers centers={centers} />);\n    }\n  }\n\n  const classes = [];\n  if (selected) {\n    classes.push(\"selected\");\n  }\n  if (error) {\n    classes.push(\"error\");\n  }\n  if (highlighted) {\n    classes.push(\"highlighted\");\n  }\n  if (locked && settings.get(\"showLocked\")) {\n    classes.push(\"locked\");\n  }\n  return (\n    <StyledSquare className={`${classes.join(\" \")}`} data-index={index}>\n      {cursor}\n      {number_or_hints}\n    </StyledSquare>\n  );\n}\n\nconst StyledSquare = styled.div`\n  background-color: ${(p) => p.theme.square};\n  position: relative;\n  transition: background-color 0.1s ease-out;\n  text-align: center;\n\n  & > * {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n  }\n\n  &.highlighted {\n    background-color: ${(p) => p.theme.squareHighlighted};\n    transition: none;\n  }\n  &.selected {\n    background-color: ${(p) => p.theme.squareSelected};\n    transition: none;\n  }\n  &.error {\n    background-color: ${(p) => p.theme.squareError};\n  }\n  &::after {\n    box-shadow: 0 0 8px ${(p) => p.theme.error};\n    content: \"\";\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 5;\n    opacity: 0;\n    transition: opacity 0.1s ease-out;\n  }\n  &.error::after {\n    opacity: 1;\n  }\n  &.selected.error {\n    background-color: ${(p) => p.theme.squareSelectedError};\n  }\n  &.locked {\n    background-color: ${(p) => p.theme.squareLocked};\n  }\n\n  @keyframes fade-in {\n    0% {\n      opacity: 0;\n      transform: translateY(0.2em);\n    }\n    100% {\n      opacity: 1;\n      transform: none;\n    }\n  }\n\n  .centers,\n  .corners {\n  }\n\n  .centers {\n  }\n\n  .corners {\n  }\n`;\n\nconst Cursor = styled.div`\n  border: solid 1px ${(p) => p.theme.base.brighten(0.2)};\n  box-sizing: border-box;\n`;\n\nfunction Number({ children }) {\n  return (\n    <StyledNumber>\n      <span>{children}</span>\n    </StyledNumber>\n  );\n}\n\nconst StyledNumber = styled.div`\n  animation: fade-in 0.1s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-family: var(--font-serif);\n  font-size: calc(var(--square-size) * 0.6);\n  font-weight: 500;\n`;\n\nfunction Corners({ corners }) {\n  const cornerNumbers = [...corners].sort();\n  const cornerGridAreas = CORNER_GRID_AREA_SETS[cornerNumbers.length];\n  const cornerEntries = [];\n  for (let i = 0; i < cornerNumbers.length; i++) {\n    cornerEntries.push({\n      n: cornerNumbers[i],\n      area: cornerGridAreas.charAt(i),\n    });\n  }\n  return (\n    <StyledCorners>\n      {cornerEntries.map(({ n, area }) => (\n        <span style={{ gridArea: area }}>{n}</span>\n      ))}\n    </StyledCorners>\n  );\n}\n\nconst StyledCorners = styled.div`\n  font-family: var(--font-sans);\n  font-size: 1em;\n  font-weight: 500;\n  align-content: space-between;\n  display: grid;\n  grid-template-areas: \"a b c\" \"d e f\" \"g h i\";\n  grid-template-rows: 1fr 1fr 1fr;\n  grid-template-columns: 1fr 1fr 1fr;\n  line-height: calc(var(--square-size) / 3);\n`;\n\nfunction Centers({ centers }) {\n  return (\n    <StyledCenters>\n      {[...centers].sort().map((n) => (\n        <span>{n}</span>\n      ))}\n    </StyledCenters>\n  );\n}\n\nconst StyledCenters = styled.div`\n  font-family: var(--font-sans);\n  font-size: 1em;\n  font-weight: 500;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSearch } from \"@fortawesome/free-solid-svg-icons\";\n\nexport const StyledButtonRow = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  & > * {\n    flex: 0 0 auto;\n  }\n\n  &.stretch > * {\n    flex: 0 1 100%;\n  }\n\n  &.large {\n    font-size: 2em;\n  }\n\n  & > :not(:last-child) {\n    border-right-width: 0;\n    border-top-right-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n  & > :not(:first-child) {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n  }\n`;\n\nexport function ButtonRow({ children, large, stretch }) {\n  const classes = [];\n  if (large) classes.push(\"large\");\n  if (stretch) classes.push(\"stretch\");\n  return (\n    <StyledButtonRow className={classes.join(\" \")}>{children}</StyledButtonRow>\n  );\n}\n\nconst StyledButtonBase = styled.div`\n  background: ${(p) => p.theme.button.darken(0.4)};\n  border: solid 1px black;\n  border-radius: var(--border-radius);\n  color: ${(p) => p.theme.text};\n  font-size: 1.5em;\n  line-height: 1.8;\n  padding: 0 0.5em;\n  text-shadow: 1px 1px 0px black;\n  touch-action: none;\n`;\n\nconst StyledButton = styled(StyledButtonBase)`\n  background: linear-gradient(\n    to bottom,\n    ${(p) => p.theme.button} 30%,\n    ${(p) => p.theme.button.darken(0.2)} 100%\n  );\n  box-shadow: inset 0px 1px 0px ${(p) => p.theme.button.brighten(0.3)};\n  &:hover {\n    background: linear-gradient(\n      to bottom,\n      ${(p) => p.theme.button.brighten(0.2)} 20%,\n      ${(p) => p.theme.button} 100%\n    );\n  }\n  &:active,\n  &.active {\n    background: linear-gradient(\n      to bottom,\n      ${(p) => p.theme.button.darken(0.2)} 20%,\n      ${(p) => p.theme.button.darken(0.1)} 100%\n    );\n    box-shadow: inset 0px 0px 1px ${(p) => p.theme.button.brighten(1)};\n  }\n  &:disabled {\n    background: ${(props) => props.theme.button.desaturate(1)};\n    box-shadow: none;\n    color: gray;\n  }\n`;\n\nexport function Button({\n  children,\n  className,\n  active,\n  enabled,\n  large,\n  onClick,\n  theme,\n}) {\n  return (\n    <StyledButton\n      as=\"button\"\n      className={`button${active ? \" active\" : \"\"}${large ? \" large\" : \"\"}${\n        className ? ` ${className}` : \"\"\n      }`}\n      disabled={enabled === false}\n      onClick={onClick}\n    >\n      {children}\n    </StyledButton>\n  );\n}\n\nexport function FocusSelector() {\n  return (\n    <ButtonRow>\n      <StyledButtonBase>\n        <FontAwesomeIcon icon={faSearch} size=\"sm\" />\n      </StyledButtonBase>\n      <Button>1</Button>\n      <Button>2</Button>\n      <Button>3</Button>\n      <Button>4</Button>\n      <Button>5</Button>\n      <Button>6</Button>\n      <Button>7</Button>\n      <Button>8</Button>\n      <Button>9</Button>\n    </ButtonRow>\n  );\n}\n","import chroma from \"chroma-js\";\nimport { Modes } from \"./Gamestate.js\";\n\nfunction makeTheme(base) {\n  const theme = { base: base };\n\n  theme.background = chroma(\"#232729\");\n  theme.border = chroma(\"#606060\");\n  theme.text = chroma(\"#d1d2d0\");\n  theme.error = chroma.lch(20, 50, 30);\n\n  theme.button = theme.base.darken(0.8);\n\n  theme.square = chroma.lch(22, 3, 252);\n  theme.squareSelected = chroma.mix(theme.square, theme.base, 0.7, \"lab\");\n  theme.squareHighlighted = chroma.mix(theme.square, theme.base, 0.2, \"lab\");\n  theme.squareError = chroma.mix(theme.square, theme.error, 0.5, \"lab\");\n  theme.squareLocked = theme.square.darken(0.2);\n  theme.squareSelectedError = chroma.mix(\n    theme.squareSelected,\n    theme.squareError,\n    0.5,\n    \"lab\"\n  );\n\n  return theme;\n}\n\nexport const Themes = {\n  red: makeTheme(chroma.lch(45, 35, 0)),\n  orange: makeTheme(chroma.lch(45, 35, 45)),\n  yellow: makeTheme(chroma.lch(45, 35, 90)),\n  green: makeTheme(chroma.lch(45, 35, 135)),\n  cyan: makeTheme(chroma.lch(45, 35, 180)),\n  blue: makeTheme(chroma.lch(45, 35, 225)),\n  indigo: makeTheme(chroma.lch(45, 35, 270)),\n  purple: makeTheme(chroma.lch(45, 35, 315)),\n};\nThemes.default = Themes.yellow;\n\nexport const ModeTheme = {};\nModeTheme[Modes.normal] = Themes.green;\nModeTheme[Modes.corners] = Themes.cyan;\nModeTheme[Modes.centers] = Themes.blue;\n","import { createBoard } from \"./Gamestate.js\";\nimport { List } from \"immutable\";\n\nexport function decodeBoard(encoded) {\n  const numbers = List(encoded).map((char) => {\n    const parsed = parseInt(char);\n    return parsed > 0 && parsed < 10 ? parsed : null;\n  });\n  return createBoard(numbers);\n}\n\nexport function encodeBoard(board) {\n  return board.map((square) => square.get(\"number\") ?? \".\").join(\"\");\n}\n\nexport function copyBoardAsURL(board) {\n  const boardstr = encodeBoard(board);\n  const url = new URL(window.location.href);\n  const params = url.searchParams;\n  params.set(\"board\", boardstr);\n  url.search = params.toString();\n  navigator.clipboard.writeText(url.href);\n}\n","import { Map } from \"immutable\";\nimport React from \"react\";\nimport styled from \"styled-components\";\n\nexport const INITIAL_SETTINGS = Map({\n  automaticallyRemoveHints: true,\n  highlightAffectedSquares: true,\n  showErrors: true,\n  showLocked: false,\n});\n\nconst SettingAction = {\n  toggle: \"toggle\",\n};\n\nexport function updateSettings(settings, { action, name }) {\n  switch (action) {\n    case SettingAction.toggle:\n      return settings.update(name, (value) => !value);\n    default:\n      throw new Error(`Invalid action: ${action}`);\n  }\n}\n\nexport function Settings({ settings, dispatchSettings }) {\n  return (\n    <SettingsFlex>\n      <SettingsGroup>\n        <legend>Gameplay</legend>\n        <SettingsUl>\n          <Toggle\n            name=\"automaticallyRemoveHints\"\n            settings={settings}\n            dispatch={dispatchSettings}\n          >\n            Automatically remove hints\n          </Toggle>\n        </SettingsUl>\n      </SettingsGroup>\n      <SettingsGroup>\n        <legend>Display</legend>\n        <SettingsUl>\n          <Toggle\n            name=\"highlightAffectedSquares\"\n            settings={settings}\n            dispatch={dispatchSettings}\n          >\n            Highlight affected squares\n          </Toggle>\n          <Toggle\n            name=\"showErrors\"\n            settings={settings}\n            dispatch={dispatchSettings}\n          >\n            Highlight errors\n          </Toggle>\n          <Toggle\n            name=\"showLocked\"\n            settings={settings}\n            dispatch={dispatchSettings}\n          >\n            Show locked squares\n          </Toggle>\n        </SettingsUl>\n      </SettingsGroup>\n    </SettingsFlex>\n  );\n}\n\nconst SettingsFlex = styled.div`\n  display: flex;\n`;\n\nconst SettingsGroup = styled.fieldset`\n  border: 1px solid ${(p) => p.theme.border};\n  padding: 0 0.75rem;\n`;\n\nconst SettingsUl = styled.ul`\n  line-height: 1.5;\n  list-style: none;\n  padding: 0;\n`;\n\nfunction Toggle({ children, name, settings, dispatch }) {\n  return (\n    <SettingsListItem>\n      <input\n        type=\"checkbox\"\n        id={`setting-${name}`}\n        checked={settings.get(name)}\n        onChange={() => dispatch({ action: SettingAction.toggle, name: name })}\n      />\n      <label for={`setting-${name}`}>{children}</label>\n    </SettingsListItem>\n  );\n}\n\nconst SettingsListItem = styled.li`\n  & > label {\n    padding-left: 0.5em;\n  }\n`;\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faBackspace, faRedo, faUndo } from \"@fortawesome/free-solid-svg-icons\";\nimport { ThemeProvider } from \"styled-components\";\nimport {\n  Action,\n  Modes,\n  canRedo,\n  canUndo,\n  createBoard,\n  createGamestate,\n  getErrors,\n  updateGamestate,\n} from \"./Gamestate.js\";\nimport { squareAt, neighbor } from \"./Geometry.js\";\nimport { Board } from \"./Board.js\";\nimport { Button, ButtonRow, FocusSelector } from \"./Buttons.js\";\nimport { Themes, ModeTheme } from \"./Theme.js\";\nimport { decodeBoard, encodeBoard, copyBoardAsURL } from \"./Loader.js\";\nimport { Settings, INITIAL_SETTINGS, updateSettings } from \"./Settings.js\";\nimport styled, { createGlobalStyle } from \"styled-components\";\nimport \"normalize.css\";\nimport { Set } from \"immutable\";\n\nconst searchParams = new URLSearchParams(window.location.search);\nconst initialBoard = searchParams.has(\"board\")\n  ? decodeBoard(searchParams.get(\"board\"))\n  : createBoard(null);\n\nexport default function App() {\n  const [mode, setMode] = useState(Modes.normal);\n  const [gamestate, dispatchGamestate] = useReducer(updateGamestate, null, () =>\n    createGamestate(initialBoard)\n  );\n  const [selection, setSelection] = useState({\n    squares: [],\n    cursor: null,\n    usingCursor: false,\n  });\n  const [settings, dispatchSettings] = useReducer(\n    updateSettings,\n    INITIAL_SETTINGS\n  );\n\n  //\n  // STATE\n  //\n  const currentBoard = gamestate.getIn([\"boards\", gamestate.get(\"index\")]);\n  const currentErrors = useMemo(\n    () => (settings.get(\"showErrors\") ? getErrors(currentBoard) : Set()),\n    [currentBoard, settings]\n  );\n\n  //\n  // SELECTION\n  //\n  const clearSelection = useCallback(() => {\n    setSelection((selection) => {\n      const newSelection = { ...selection };\n      newSelection.squares = [];\n      return newSelection;\n    });\n  }, []);\n\n  const selectSquare = useCallback((i) => {\n    console.log(`selectSquare(${i})`);\n    setSelection((selection) => {\n      if (selection.squares.includes(i)) {\n        return selection;\n      }\n      const newSelection = { ...selection };\n      newSelection.squares = [...selection.squares];\n      newSelection.squares.push(i);\n      newSelection.cursor = i;\n      newSelection.usingCursor = false;\n      return newSelection;\n    });\n  }, []);\n\n  const selectSquareAtCoordinates = useCallback(\n    (x, y) => {\n      console.log(`selectSquareAtCoordinates(${x}, ${y})`);\n      const i = squareAt(x, y);\n      if (i !== null) {\n        selectSquare(i);\n      }\n    },\n    [selectSquare]\n  );\n\n  const selectDirection = useCallback(\n    (direction) => {\n      setSelection((selection) => {\n        let i = neighbor(selection.cursor, direction) ?? selection.cursor;\n        const newSelection = { ...selection };\n        newSelection.squares = [...selection.squares, i];\n        newSelection.cursor = i;\n        newSelection.usingCursor = true;\n        return newSelection;\n      });\n    },\n    [setSelection]\n  );\n\n  //\n  // ACTIONS\n  //\n  const inputDigit = useCallback(\n    (digit) => {\n      console.log(`inputDigit(${digit})`);\n      dispatchGamestate({\n        action: Action.input,\n        squares: selection.squares,\n        digit: digit,\n        mode: mode,\n        settings: settings,\n      });\n    },\n    [mode, selection, settings]\n  );\n\n  //\n  // TOUCH\n  //\n  const selectTouchedSquares = useCallback(\n    (e) => {\n      for (let touch of e.changedTouches) {\n        selectSquareAtCoordinates(touch.pageX, touch.pageY);\n      }\n    },\n    [selectSquareAtCoordinates]\n  );\n\n  const handleTouchMove = useCallback(\n    (e) => {\n      console.log(`handleTouchMove()`);\n      selectTouchedSquares(e);\n    },\n    [selectTouchedSquares]\n  );\n\n  const handleTouchStart = useCallback(\n    (e) => {\n      console.log(`handleTouchStart()`);\n      e.preventDefault();\n      if (e.touches.length === 1 && !e.ctrlKey) {\n        clearSelection();\n      }\n      selectTouchedSquares(e);\n    },\n    [clearSelection, selectTouchedSquares]\n  );\n\n  //\n  // MOUSE\n  //\n  const handleMouseDown = useCallback(\n    (e) => {\n      console.log(`handleMouseDown()`);\n      if (!e.ctrlKey && !e.shiftKey) {\n        clearSelection();\n      }\n      selectSquareAtCoordinates(e.pageX, e.pageY);\n    },\n    [clearSelection, selectSquareAtCoordinates]\n  );\n\n  const handleMouseMove = useCallback(\n    (e) => {\n      console.log(`handleMouseMove()`);\n      if (e.buttons === 1) {\n        selectSquareAtCoordinates(e.pageX, e.pageY);\n      }\n    },\n    [selectSquareAtCoordinates]\n  );\n\n  //\n  // KEYBOARD\n  //\n  const moveCursor = useCallback(\n    (e) => {\n      if (!e.shiftKey && !e.ctrlKey) {\n        clearSelection();\n      }\n      selectDirection(e.key.substring(5).toLowerCase());\n    },\n    [clearSelection, selectDirection]\n  );\n  const handleKeyDown = useCallback(\n    (e) => {\n      switch (e.key) {\n        case \"Escape\":\n          clearSelection();\n          break;\n        case \"ArrowRight\":\n        case \"ArrowLeft\":\n        case \"ArrowUp\":\n        case \"ArrowDown\":\n          moveCursor(e);\n          break;\n        case \"1\":\n        case \"2\":\n        case \"3\":\n        case \"4\":\n        case \"5\":\n        case \"6\":\n        case \"7\":\n        case \"8\":\n        case \"9\":\n          inputDigit(parseInt(e.key));\n          break;\n        case \"Backspace\":\n          inputDigit(null);\n          break;\n        default:\n          console.log(`Unhandled keydown: ${e}`);\n          return;\n      }\n      e.preventDefault();\n    },\n    [clearSelection, inputDigit, moveCursor]\n  );\n  useEffect(() => {\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => {\n      document.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, [handleKeyDown]);\n\n  //\n  // RENDER\n  //\n  const boardArea = useRef(null);\n  useEffect(() => {\n    const node = boardArea.current;\n    node.addEventListener(\"mousedown\", handleMouseDown);\n    node.addEventListener(\"mousemove\", handleMouseMove);\n    node.addEventListener(\"touchmove\", handleTouchMove);\n    node.addEventListener(\"touchstart\", handleTouchStart);\n    return () => {\n      node.removeEventListener(\"mousedown\", handleMouseDown);\n      node.removeEventListener(\"mousemove\", handleMouseMove);\n      node.removeEventListener(\"touchmove\", handleTouchMove);\n      node.removeEventListener(\"touchstart\", handleTouchStart);\n    };\n  }, [handleMouseDown, handleMouseMove, handleTouchMove, handleTouchStart]);\n\n  return (\n    <ThemeProvider theme={Themes.default}>\n      <GlobalStyle />\n      <FlexRow>\n        <FocusSelector />\n        <ThemeProvider theme={Themes.red}>\n          <ButtonRow>\n            <Button\n              onClick={() => dispatchGamestate({ action: Action.undo })}\n              enabled={canUndo(gamestate)}\n            >\n              <FontAwesomeIcon icon={faUndo} size=\"sm\" />\n            </Button>\n            <Button\n              onClick={() => dispatchGamestate({ action: Action.redo })}\n              enabled={canRedo(gamestate)}\n            >\n              <FontAwesomeIcon icon={faRedo} size=\"sm\" />\n            </Button>\n          </ButtonRow>\n        </ThemeProvider>\n      </FlexRow>\n      <ThemeProvider theme={ModeTheme[mode]}>\n        <Board\n          boardAreaRef={boardArea}\n          handleTouchMove={handleTouchMove}\n          board={currentBoard}\n          errors={currentErrors}\n          selection={selection}\n          settings={settings}\n        />\n      </ThemeProvider>\n      <div>\n        <ButtonRow stretch>\n          <ThemeProvider theme={ModeTheme[Modes.normal]}>\n            <Button\n              active={mode === Modes.normal}\n              onClick={() => setMode(Modes.normal)}\n              theme=\"normal\"\n            >\n              normal\n            </Button>\n          </ThemeProvider>\n          <ThemeProvider theme={ModeTheme[Modes.corners]}>\n            <Button\n              active={mode === Modes.corners}\n              onClick={() => setMode(Modes.corners)}\n              theme=\"corners\"\n            >\n              corner\n            </Button>\n          </ThemeProvider>\n          <ThemeProvider theme={ModeTheme[Modes.centers]}>\n            <Button\n              active={mode === Modes.centers}\n              onClick={() => setMode(Modes.centers)}\n              theme=\"centers\"\n            >\n              center\n            </Button>\n          </ThemeProvider>\n        </ButtonRow>\n        <ThemeProvider theme={ModeTheme[mode]}>\n          <ButtonRow large stretch>\n            <Button onClick={() => inputDigit(1)}>1</Button>\n            <Button onClick={() => inputDigit(2)}>2</Button>\n            <Button onClick={() => inputDigit(3)}>3</Button>\n            <Button onClick={() => inputDigit(4)}>4</Button>\n            <Button onClick={() => inputDigit(5)}>5</Button>\n            <Button onClick={() => inputDigit(6)}>6</Button>\n            <Button onClick={() => inputDigit(7)}>7</Button>\n            <Button onClick={() => inputDigit(8)}>8</Button>\n            <Button onClick={() => inputDigit(9)}>9</Button>\n            <Button onClick={() => inputDigit(null)}>\n              <FontAwesomeIcon icon={faBackspace} size=\"sm\" />\n            </Button>\n          </ButtonRow>\n        </ThemeProvider>\n      </div>\n      <Settings settings={settings} dispatchSettings={dispatchSettings} />\n      <p>\n        Current board: <tt>{encodeBoard(currentBoard)}</tt>\n      </p>\n      <Button onClick={() => copyBoardAsURL(currentBoard)}>\n        Copy current board URL\n      </Button>\n      <ol>\n        <li>\n          <a href=\"?\">Empty puzzle</a>\n        </li>\n        <li>\n          <a href=\"?board=7.4..6..9.8..1......3.2.45.........2.56...78.1.........25.3.1......4..6.9..5..3.7\">\n            #1\n          </a>\n        </li>\n        <li>\n          <a href=\"?board=....2.......738....5.4.6.7.1.......896.....41.8.6.1.2...25.71....9.8.7..3.......6\">\n            #2\n          </a>\n        </li>\n      </ol>\n    </ThemeProvider>\n  );\n}\n\nconst GlobalStyle = createGlobalStyle`\n  :root {\n    --border-radius: 10px;\n    --font-serif: \"Literata\", serif;\n    --font-sans: \"Inter\", sans-serif;\n    --font-hint: \"Inconsolata\", monospace;\n  }\n\n  body {\n      background-color: ${(p) => p.theme.background};\n      color: ${(p) => p.theme.text};\n    font-family: var(--font-sans);\n    line-height: 1;\n    margin: 0;\n  }\n\n  .title {\n    font-family: var(--font-serif);\n    margin-top: 0.5em;\n    text-align: center;\n  }\n\n  #root {\n    display: flex;\n    flex-direction: column;\n    margin-top: 1rem;\n  }\n\n  #root > * {\n    flex-grow: 1;\n    margin: 0 1rem;\n  }\n  #root > * + * {\n    margin-top: 1rem;\n  }\n\n  a {\n    color: inherit;\n  }\n`;\n\nconst FlexRow = styled.div`\n  display: flex;\n  justify-content: center;\n`;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}